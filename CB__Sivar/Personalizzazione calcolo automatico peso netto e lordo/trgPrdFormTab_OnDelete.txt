/*
*
*
*
*/
CREATE TRIGGER [dbo].[trgPrdFormTab_OnDelete]
ON [dbo].[PrdFormTab]
FOR DELETE
AS
Declare @sTabCod varchar(32)

SET NOCOUNT ON

Declare [cCursor] Cursor LOCAL FAST_FORWARD For
Select TabCod
From deleted

Open [cCursor]
Fetch Next From [cCursor] Into @sTabCod
While (@@Fetch_Status <> -1)
Begin
	Delete dbo.[PrdFormLocTexts]
	Where TableID In('PrdFormTab', 'PrdFormTabLin')
		And ItemName1 = @sTabCod

	Delete dbo.[PrdFormTabLin]
	Where TabCod = @sTabCod

	Delete dbo.[PrdFormTabLinEx_Pers]
	Where TabCod = @sTabCod
	-- ----------------------------------------------------------
	Fetch Next From [cCursor] Into @sTabCod
End
Close [cCursor]
Deallocate [cCursor]